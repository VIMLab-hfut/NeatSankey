"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj};!function(factory){"function"==typeof define&&define.amd?define(["jquery","ChineseDistricts"],factory):"object"===("undefined"==typeof exports?"undefined":_typeof(exports))?factory(require("jquery"),require("ChineseDistricts")):factory(jQuery,ChineseDistricts)}(function($,ChineseDistricts){if(void 0===ChineseDistricts)throw new Error('The file "distpicker.data.js" must be included first!');var EVENT_CHANGE="change.distpicker";function Distpicker(element,options){this.$element=$(element),this.options=$.extend({},Distpicker.DEFAULTS,$.isPlainObject(options)&&options),this.placeholders=$.extend({},Distpicker.DEFAULTS),this.active=!1,this.init()}Distpicker.prototype={constructor:Distpicker,init:function(){var options=this.options,$select=this.$element.find("select"),length=$select.length,data={};$select.each(function(){$.extend(data,$(this).data())}),$.each(["province","city","district"],$.proxy(function(i,type){data[type]?(options[type]=data[type],this["$"+type]=$select.filter("[data-"+type+"]")):this["$"+type]=i<length?$select.eq(i):null},this)),this.bind(),this.reset(),this.active=!0},bind:function(){this.$province&&this.$province.on(EVENT_CHANGE,this._changeProvince=$.proxy(function(){this.output("city"),this.output("district")},this)),this.$city&&this.$city.on(EVENT_CHANGE,this._changeCity=$.proxy(function(){this.output("district")},this))},unbind:function(){this.$province&&this.$province.off(EVENT_CHANGE,this._changeProvince),this.$city&&this.$city.off(EVENT_CHANGE,this._changeCity)},output:function(type){var districts,code,matched,value,options=this.options,placeholders=this.placeholders,$select=this["$"+type],data=[];$select&&$select.length&&(value=options[type],code="province"===type?86:"city"===type?this.$province&&this.$province.find(":selected").data("code"):"district"===type?this.$city&&this.$city.find(":selected").data("code"):code,districts=$.isNumeric(code)?ChineseDistricts[code]:null,$.isPlainObject(districts)&&$.each(districts,function(code,address){var selected=address===value;selected&&(matched=!0),data.push({code:code,address:address,selected:selected})}),matched||(data.length&&(options.autoSelect||options.autoselect)&&(data[0].selected=!0),!this.active&&value&&(placeholders[type]=value)),options.placeholder&&data.unshift({code:"",address:placeholders[type],selected:!1}),$select.html(this.getList(data)))},getList:function(data){var list=[];return $.each(data,function(i,n){list.push('<option value="'+(n.address&&n.code?n.address:"")+'" data-code="'+(n.code||"")+'"'+(n.selected?" selected":"")+">"+(n.address||"")+"</option>")}),list.join("")},reset:function(deep){deep?this.$province&&this.$province.find(":first").prop("selected",!0).trigger(EVENT_CHANGE):(this.output("province"),this.output("city"),this.output("district"))},destroy:function(){this.unbind(),this.$element.removeData("distpicker")}},Distpicker.DEFAULTS={autoSelect:!0,placeholder:!0,province:"--所在省--",city:"--所在市--",district:"--所在区--"},Distpicker.setDefaults=function(options){$.extend(Distpicker.DEFAULTS,options)},Distpicker.other=$.fn.distpicker,$.fn.distpicker=function(option){var args=[].slice.call(arguments,1);return this.each(function(){var options,fn,$this=$(this),data=$this.data("distpicker");if(!data){if(/destroy/.test(option))return;options=$.extend({},$this.data(),$.isPlainObject(option)&&option),$this.data("distpicker",data=new Distpicker(this,options))}"string"==typeof option&&$.isFunction(fn=data[option])&&fn.apply(data,args)})},$.fn.distpicker.Constructor=Distpicker,$.fn.distpicker.setDefaults=Distpicker.setDefaults,$.fn.distpicker.noConflict=function(){return $.fn.distpicker=Distpicker.other,this},$(function(){$('[data-toggle="distpicker"]').distpicker()})});